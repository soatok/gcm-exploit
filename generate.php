<?php
declare(strict_types=1);

use Soatok\GCMCollider\Collider;

require_once "vendor/autoload.php";
const PLAIN_A = "Dholes are the best fursona ever";
const PLAIN_B = "These are not the droids we seek";

if ((mb_strlen(PLAIN_A, '8bit') & 0xf) !== 0) {
    die('PLAIN_A is not an even multiple of 16 bytes');
}
if ((mb_strlen(PLAIN_B, '8bit') & 0xf) !== 0) {
    die('PLAIN_B is not an even multiple of 16 bytes');
}

$collider = new Collider();
$payload = $collider->generateUncool(PLAIN_A, PLAIN_B);
$keys = $collider->getKeys();

var_dump([
    'payload' => bin2hex($payload),
    'keys' => $keys
]);


